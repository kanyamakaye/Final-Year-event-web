{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="events-container">
    <div class="events-header">
        <h2>Free Events</h2>
        <p class="subtitle">Browse and register for our free events</p>
    </div>

    <div class="stats-card">
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-icon">
                    <i class="fas fa-calendar-alt"></i>
                </div>
                <div class="stat-content">
                    <div class="stat-value">{{ total_free_events }}</div>
                    <div class="stat-label">Total Free Events</div>
                </div>
            </div>
            
            <div class="stat-item">
                <div class="stat-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-content">
                    <div class="stat-value">{{ upcoming_count }}</div>
                    <div class="stat-label">Upcoming Events</div>
                </div>
            </div>
            
            <div class="stat-item">
                <div class="stat-icon">
                    <i class="fas fa-history"></i>
                </div>
                <div class="stat-content">
                    <div class="stat-value">{{ past_count }}</div>
                    <div class="stat-label">Past Events</div>
                </div>
            </div>
        </div>
    </div>

    <div class="filter-section">
        <div class="category-filter">
            <label for="category-select">Filter by Category:</label>
            <select id="category-select" onchange="window.location.href=this.value">
                <option value="{% url 'free_events' %}" {% if not selected_category %}selected{% endif %}>All Categories</option>
                {% for category in categories %}
                <option value="{% url 'free_events' %}?category={{ category.id }}" 
                        {% if selected_category == category.id %}selected{% endif %}>
                    {{ category.name }}
                </option>
                {% endfor %}
            </select>
        </div>
    </div>

    {% if upcoming_events %}
    <div class="events-section">
        <h3>Upcoming Free Events</h3>
        <div class="events-grid">
            {% for event in upcoming_events %}
            <div class="event-card">
                <div class="event-header">
                    <h4>{{ event.title }}</h4>
                    <span class="event-category">{{ event.category.name }}</span>
                </div>
                <div class="event-details">
                    <p class="event-description">{{ event.description|truncatewords:30 }}</p>
                    <div class="event-meta">
                        <div class="meta-item">
                            <i class="fas fa-calendar"></i>
                            <span>{{ event.start_date|date:"M d, Y" }} - {{ event.end_date|date:"M d, Y" }}</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>{{ event.location }}</span>
                        </div>
                        {% if event.available_tickets %}
                        <div class="meta-item">
                            <i class="fas fa-ticket-alt"></i>
                            <span>{{ event.available_tickets }} tickets available</span>
                        </div>
                        {% endif %}
                    </div>
                    <div class="event-speakers">
                        <h5>Speakers</h5>
                        <div class="speakers-list">
                            {% for speaker in event.speaker_management_set.all %}
                            <div class="speaker-item">
                                <i class="fas fa-user"></i>
                                <span>{{ speaker.name }}</span>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div class="event-actions">
                    <a href="{% url 'event_details' event.title %}" class="btn btn-primary">View Details</a>
                    <a href="{% url 'participant_forms' %}" class="btn btn-secondary">Register</a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    {% if past_events %}
    <div class="events-section">
        <h3>Past Free Events</h3>
        <div class="events-grid">
            {% for event in past_events %}
            <div class="event-card">
                <div class="event-header">
                    <h4>{{ event.title }}</h4>
                    <span class="event-category">{{ event.category.name }}</span>
                </div>
                <div class="event-details">
                    <p class="event-description">{{ event.description|truncatewords:30 }}</p>
                    <div class="event-meta">
                        <div class="meta-item">
                            <i class="fas fa-calendar"></i>
                            <span>{{ event.start_date|date:"M d, Y" }} - {{ event.end_date|date:"M d, Y" }}</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>{{ event.location }}</span>
                        </div>
                    </div>
                </div>
                <div class="event-actions">
                    <a href="{% url 'event_details' event.title %}" class="btn btn-secondary">View Details</a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/free_events.css' %}">
{% endblock %}
